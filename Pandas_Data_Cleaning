import pandas as pd

# Load the raw file
df_raw = pd.read_csv("Insert_Path", encoding="utf-8", sep=None, engine='python', header=None)

# Extract headers
header_group = df_raw.iloc[1]
header_type = df_raw.iloc[2]

# Combine headers
combined_headers = []
for group, dtype in zip(header_group, header_type):
    if pd.isna(group) and pd.notna(dtype):
        group = combined_headers[-1].split("_")[0]
    elif pd.isna(group) and pd.isna(dtype):
        combined_headers.append("Unnamed")
        continue
    combined_headers.append(f"{str(group).strip()}_{str(dtype).strip()}")

# Assign combined headers
df_clean = df_raw.iloc[3:].copy()
df_clean.columns = combined_headers

# Drop empty rows/columns
df_clean.dropna(axis=0, how="all", inplace=True)
df_clean.dropna(axis=1, how="all", inplace=True)

# Replace "-" with 0 and remove commas
df_clean.replace("-", 0, inplace=True)
df_clean = df_clean.applymap(lambda x: str(x).replace(",", "") if isinstance(x, str) else x)
df_clean = df_clean.applymap(lambda x: float(x) if str(x).replace('.', '', 1).isdigit() else x)


df_clean.to_csv("NEW_FILE_NAME", index=False)
